<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MoviesFinder</title>
  <style>
    body { font-family: Arial, sans-serif; background:#111; color:#fff; text-align:center; }
    #results img { width:200px; border-radius:10px; margin:10px; }
    .movie { margin-bottom:40px; }
    iframe { border-radius:10px; margin-top:10px; }
    .btn { padding:10px 20px; margin:10px; background:#ff3c00; color:#fff; border:none; border-radius:5px; cursor:pointer; }
  </style>
</head>
<body>
  <h1>ðŸŽ¬ MoviesFinder</h1>
  <input type="text" id="search" placeholder="Search for a movie...">
  <button class="btn" onclick="findMovie()">Search</button>
  <div id="results"></div>

  <script>
    const apiKey = "f6bbd78cbc9ce2dd541c4e6f458a5250";

    async function findMovie() {
      let query = document.getElementById("search").value.trim();
      if (!query) {
        alert("Please enter a movie name");
        return;
      }

      let url = `https://api.themoviedb.org/3/search/movie?api_key=${apiKey}&query=${encodeURIComponent(query)}`;
      let res = await fetch(url);
      let data = await res.json();

      document.getElementById("results").innerHTML = "";

      if (data.results && data.results.length > 0) {
        let movie = data.results[0];
        let movieId = movie.id;

        // fetch trailer
        let trailerRes = await fetch(`https://api.themoviedb.org/3/movie/${movieId}/videos?api_key=${apiKey}`);
        let trailerData = await trailerRes.json();
        let trailer = trailerData.results.find(v => v.type === "Trailer" && v.site === "YouTube");

        // fetch watch providers
        let providerRes = await fetch(`https://api.themoviedb.org/3/movie/${movieId}/watch/providers?api_key=${apiKey}`);
        let providerData = await providerRes.json();
        let providers = providerData.results?.PK; // use PK (Pakistan), can change to US/IN etc.

        // build buttons
        let watchButton = "";
        let downloadButton = "";

        if (providers && providers.link) {
          watchButton = `<button class="btn" onclick="window.open('${providers.link}', '_blank')">â–¶ Watch Online</button>`;
          downloadButton = `<button class="btn" onclick="window.open('${providers.link}', '_blank')">â¬‡ Download</button>`;
        } else {
          // fallback if no legal providers
          watchButton = `<button class="btn" onclick="window.open('https://www.youtube.com/results?search_query=${encodeURIComponent(movie.title)}+trailer', '_blank')">â–¶ Watch Online</button>`;
          downloadButton = `<button class="btn" onclick="window.open('https://www.google.com/search?q=${encodeURIComponent(movie.title)}+download', '_blank')">â¬‡ Download</button>`;
        }

        document.getElementById("results").innerHTML = `
          <div class="movie">
            <h2>${movie.title}</h2>
            <img src="https://image.tmdb.org/t/p/w500${movie.poster_path}" alt="${movie.title}">
            <p>${movie.overview}</p>
            ${trailer ? `<iframe width="560" height="315" src="https://www.youtube.com/embed/${trailer.key}" frameborder="0" allowfullscreen></iframe>` : "<p>No trailer found</p>"}
            <br>
            ${watchButton}
            ${downloadButton}
          </div>
        `;
      } else {
        document.getElementById("results").innerHTML = "<p>No results found</p>";
      }
    }
  </script>
</body>
</html>

